<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Vacayo - Your trips, on a timeline</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="logo">
                    <i data-lucide="plane" class="logo-icon"></i>
                    <h1>Vacayo</h1>
                </div>
                <div class="header-actions">
                    <button class="theme-toggle" onclick="openSettings()" title="Réglages">
                        <i data-lucide="settings"></i>
                    </button>
                    <button class="theme-toggle" onclick="toggleTheme()" id="themeToggle" title="Thème">
                        <i data-lucide="moon" id="themeIcon"></i>
                    </button>
                </div>
            </div>
        </header>

        <div class="dashboard" id="dashboard">
            <div class="stat-card">
                <h3>Restaurants</h3>
                <div class="number" id="totalRestaurants">0</div>
            </div>
            <div class="stat-card">
                <h3>Activités</h3>
                <div class="number" id="totalActivities">0</div>
            </div>
            <div class="stat-card">
                <h3>Budget</h3>
                <div class="number" id="totalBudget">0¥</div>
            </div>
            <div class="stat-card">
                <h3>Réservés</h3>
                <div class="number" id="totalReservations">0</div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('all')">
                <i data-lucide="layout-grid" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                Tout
            </button>
            <button class="tab" onclick="switchTab('restaurants')">
                <i data-lucide="utensils" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                Restaurants
            </button>
            <button class="tab" onclick="switchTab('activities')">
                <i data-lucide="compass" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                Activités
            </button>
            <button class="tab" onclick="switchTab('calendar')">
                <i data-lucide="calendar" style="width: 16px; height: 16px; margin-right: 6px;"></i>
                Calendrier
            </button>
        </div>


        <!-- Search Bar -->
        <div class="search-bar">
            <div class="search-input-wrapper">
                <i data-lucide="search" class="search-icon"></i>
                <input type="text" id="searchInput" placeholder="Rechercher..." oninput="filterItems()">
            </div>
        </div>

        <!-- Filters -->
        <div class="filters-bar">
            <select id="cityFilter" onchange="filterItems()" class="filter-select">
                <option value="">Toutes les villes</option>
                <optgroup label="Tokyo">
                    <option value="Tokyo">Tokyo (toute la ville)</option>
                    <option value="Tokyo - Shibuya">Tokyo - Shibuya</option>
                    <option value="Tokyo - Shinjuku">Tokyo - Shinjuku</option>
                    <option value="Tokyo - Ikebukuro">Tokyo - Ikebukuro</option>
                    <option value="Tokyo - Ginza">Tokyo - Ginza</option>
                    <option value="Tokyo - Harajuku">Tokyo - Harajuku</option>
                    <option value="Tokyo - Akihabara">Tokyo - Akihabara</option>
                    <option value="Tokyo - Asakusa">Tokyo - Asakusa</option>
                    <option value="Tokyo - Roppongi">Tokyo - Roppongi</option>
                    <option value="Tokyo - Odaiba">Tokyo - Odaiba</option>
                </optgroup>
                <optgroup label="Sapporo">
                    <option value="Sapporo">Sapporo (toute la ville)</option>
                    <option value="Sapporo - Susukino">Sapporo - Susukino</option>
                    <option value="Sapporo - Odori">Sapporo - Odori</option>
                    <option value="Sapporo - Tanukikoji">Sapporo - Tanukikoji</option>
                </optgroup>
                <optgroup label="Seoul">
                    <option value="Seoul">Seoul (toute la ville)</option>
                    <option value="Seoul - Gangnam">Seoul - Gangnam</option>
                    <option value="Seoul - Hongdae">Seoul - Hongdae</option>
                    <option value="Seoul - Myeongdong">Seoul - Myeongdong</option>
                    <option value="Seoul - Itaewon">Seoul - Itaewon</option>
                    <option value="Seoul - Insadong">Seoul - Insadong</option>
                </optgroup>
            </select>
            <select id="sortBy" onchange="sortItems()" class="filter-select">
                <option value="none">Tri par défaut</option>
                <option value="priority">Priorité</option>
                <option value="price-asc">Prix ↑</option>
                <option value="price-desc">Prix ↓</option>
                <option value="name">Nom A-Z</option>
            </select>
        </div>

        <div id="allContent" class="content-section active">
            <div class="items-list" id="allItems"></div>
        </div>

        <div id="restaurantsContent" class="content-section">
            <div class="items-list" id="restaurantItems"></div>
        </div>

        <div id="activitiesContent" class="content-section">
            <div class="items-list" id="activityItems"></div>
        </div>

        <div id="calendarContent" class="content-section">
            <div id="calendarView"></div>
        </div>
    </div>

    <!-- Modal Réglages -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" style="display: flex; align-items: center; gap: 12px;">
                    <i data-lucide="settings" style="width: 24px; height: 24px;"></i>
                    Réglages
                </h2>
                <button class="close-btn" onclick="closeModal('settingsModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div style="background: var(--bg-secondary); border: 2px solid var(--border-color); border-radius: 12px; padding: 20px; margin-bottom: 20px;">
                    <h3 style="font-size: 1.125rem; font-weight: 600; margin-bottom: 16px; color: var(--text-primary); display: flex; align-items: center; gap: 8px;">
                        <i data-lucide="database" style="width: 20px; height: 20px;"></i>
                        Gestion des données
                    </h3>
                    <p style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 20px;">
                        Exportez vos données pour les sauvegarder ou les partager, importez un fichier de sauvegarde, ou réinitialisez complètement l'application.
                    </p>
                    
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <button class="btn" onclick="exportData()" style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 8px;">
                            <i data-lucide="download" style="width: 18px; height: 18px;"></i>
                            Exporter les données
                        </button>
                        <button class="btn" onclick="importData()" style="width: 100%; display: flex; align-items: center; justify-content: center; gap: 8px;">
                            <i data-lucide="upload" style="width: 18px; height: 18px;"></i>
                            Importer les données
                        </button>
                        <button class="btn" onclick="clearAllData()" style="width: 100%; background: var(--error); color: white; display: flex; align-items: center; justify-content: center; gap: 8px;">
                            <i data-lucide="trash-2" style="width: 18px; height: 18px;"></i>
                            Supprimer toutes les données
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Form -->
    <div id="formModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Ajouter un Restaurant</h2>
                <button class="close-btn" onclick="closeModal('formModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="itemForm">
                    <input type="hidden" id="itemId">
                    <input type="hidden" id="itemType">

                    <div class="form-group">
                        <label for="itemName">Nom *</label>
                        <input type="text" id="itemName" required>
                    </div>

                    <div class="form-group">
                        <label for="itemCity">Ville *</label>
                        <select id="itemCity" required>
                            <option value="">Sélectionner...</option>
                            <optgroup label="Tokyo">
                                <option value="Tokyo">Tokyo (général)</option>
                                <option value="Tokyo - Shibuya">Tokyo - Shibuya</option>
                                <option value="Tokyo - Shinjuku">Tokyo - Shinjuku</option>
                                <option value="Tokyo - Ikebukuro">Tokyo - Ikebukuro</option>
                                <option value="Tokyo - Ginza">Tokyo - Ginza</option>
                                <option value="Tokyo - Harajuku">Tokyo - Harajuku</option>
                                <option value="Tokyo - Akihabara">Tokyo - Akihabara</option>
                                <option value="Tokyo - Asakusa">Tokyo - Asakusa</option>
                                <option value="Tokyo - Roppongi">Tokyo - Roppongi</option>
                                <option value="Tokyo - Odaiba">Tokyo - Odaiba</option>
                            </optgroup>
                            <optgroup label="Sapporo">
                                <option value="Sapporo">Sapporo (général)</option>
                                <option value="Sapporo - Susukino">Sapporo - Susukino</option>
                                <option value="Sapporo - Odori">Sapporo - Odori</option>
                                <option value="Sapporo - Tanukikoji">Sapporo - Tanukikoji</option>
                            </optgroup>
                            <optgroup label="Seoul">
                                <option value="Seoul">Seoul (général)</option>
                                <option value="Seoul - Gangnam">Seoul - Gangnam</option>
                                <option value="Seoul - Hongdae">Seoul - Hongdae</option>
                                <option value="Seoul - Myeongdong">Seoul - Myeongdong</option>
                                <option value="Seoul - Itaewon">Seoul - Itaewon</option>
                                <option value="Seoul - Insadong">Seoul - Insadong</option>
                            </optgroup>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="category" id="categoryLabel">Catégorie</label>
                        <input type="text" id="category" placeholder="Ex: Omakase, Ramen, Temple, Shopping...">
                    </div>

                    <div class="form-group">
                        <label for="price">Prix (¥)</label>
                        <input type="number" id="price" placeholder="0">
                    </div>

                    <div class="form-group">
                        <label for="googleMapsUrl">Google Maps (URL)</label>
                        <input type="url" id="googleMapsUrl" placeholder="https://maps.app.goo.gl/...">
                    </div>

                    <div class="form-group">
                        <label for="bookingUrl">Lien de réservation (URL)</label>
                        <input type="url" id="bookingUrl" placeholder="https://...">
                    </div>

                    <div class="form-group">
                        <label for="photoUrl">Photo (URL)</label>
                        <input type="url" id="photoUrl" placeholder="https://...">
                    </div>

                    <div class="form-group">
                        <label for="priority">Priorité</label>
                        <select id="priority">
                            <option value="must-do">Must-Do (Incontournable)</option>
                            <option value="high">Haute</option>
                            <option value="normal" selected>Normale</option>
                            <option value="low">Basse</option>
                            <option value="optional">Optionnel</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="notes">Notes</label>
                        <textarea id="notes" rows="3"></textarea>
                    </div>

                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="isBooked">
                            <span id="bookedLabel">Réservé</span>
                        </label>
                    </div>

                    <div class="form-group" id="reservationDateGroup" style="display: none;">
                        <label for="reservationDate">Date</label>
                        <input type="datetime-local" id="reservationDate">
                    </div>
                </form>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary" onclick="saveItem(event)" style="flex: 2;">Enregistrer</button>
                <button type="button" class="btn" onclick="closeModal('formModal')">Annuler</button>
            </div>
        </div>
    </div>

    <!-- Modal Detail -->
    <div id="detailModal" class="modal detail-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="detailTitle"></h2>
                <button class="close-btn" onclick="closeModal('detailModal')">&times;</button>
            </div>
            <div class="modal-body" id="detailBody"></div>
            <div class="form-actions">
                <button class="btn btn-primary" onclick="editFromDetail()">Modifier</button>
                <button class="btn" onclick="deleteFromDetail()">Supprimer</button>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation (Mobile) -->
    <nav class="bottom-nav">
        <button class="bottom-nav-item active" onclick="bottomNavSwitch('all')" data-nav="all">
            <i data-lucide="layout-grid" class="icon"></i>
            <span>Tout</span>
        </button>
        <button class="bottom-nav-item" onclick="bottomNavSwitch('restaurants')" data-nav="restaurants">
            <i data-lucide="utensils" class="icon"></i>
            <span>Restos</span>
        </button>
        <button class="bottom-nav-item" onclick="bottomNavSwitch('activities')" data-nav="activities">
            <i data-lucide="compass" class="icon"></i>
            <span>Activités</span>
        </button>
        <button class="bottom-nav-item" onclick="bottomNavSwitch('calendar')" data-nav="calendar">
            <i data-lucide="calendar" class="icon"></i>
            <span>Calendrier</span>
        </button>
    </nav>

    <!-- FAB Button -->
    <button class="fab" id="fab" onclick="toggleFabMenu()">
        <i data-lucide="plus" style="width: 24px; height: 24px;"></i>
    </button>
    
    <!-- FAB Menu -->
    <div class="fab-menu" id="fabMenu">
        <button class="fab-option" onclick="openModal('restaurant'); closeFabMenu();">
            <i data-lucide="utensils" style="width: 16px; height: 16px; margin-right: 8px;"></i>
            Restaurant
        </button>
        <button class="fab-option" onclick="openModal('activity'); closeFabMenu();">
            <i data-lucide="compass" style="width: 16px; height: 16px; margin-right: 8px;"></i>
            Activité
        </button>
    </div>

    <!-- Scripts dans l'ordre de dépendance -->
    <script src="js/init-data.js"></script>
    <script src="js/utils/helpers.js"></script>
    <script src="js/models/Activity.js"></script>
    <script src="js/services/storage.js"></script>
    <script src="js/utils/sort.js"></script>
    <script src="js/ui/theme.js"></script>
    <script src="js/ui/modal.js"></script>
    <script src="js/ui/navigation.js"></script>
    <script src="js/components/dashboard.js"></script>
    <script src="js/components/list.js"></script>
    <script src="js/components/calendar.js"></script>
    <script src="js/app.js"></script>
</body>
</html>